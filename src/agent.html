<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>AI Assistant Chat with Canvas</title>
  <style>
    /* Global Reset */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      background-color: #0a0a0a;
      font-family: "Helvetica Neue", Arial, sans-serif;
      height: 100vh;
      display: grid;
      grid-template-columns: 400px 1fr;
      grid-template-rows: 1fr;
      gap: 15px;
      padding: 15px;
      color: #fff;
    }

    /* Window styling */
    .window {
      background-color: #1a1a1a;
      border-radius: 15px;
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
      border: 1px solid rgba(255, 255, 255, 0.05);
      padding: 20px;
      color: #fff;
      backdrop-filter: blur(10px);
    }

    /* Top left windows container */
    .top-left-container {
      grid-column: 1;
      grid-row: 1;
      display: flex;
      flex-direction: column;
      gap: 15px;
      height: 100%;
    }

    /* Response window */
    .response-window {
      flex: 2;
      min-height: 0;
      display: flex;
      flex-direction: column;
      position: relative;
    }

    .view-toggle {
      position: absolute;
      top: 15px;
      right: 15px;
      display: flex;
      gap: 8px;
      z-index: 10;
      background: rgba(26, 26, 26, 0.8);
      padding: 5px;
      border-radius: 10px;
      backdrop-filter: blur(5px);
    }

    .view-toggle button {
      background: transparent;
      border: 1px solid rgba(255, 255, 255, 0.1);
      padding: 8px 15px;
      border-radius: 8px;
      color: #fff;
      cursor: pointer;
      font-size: 0.9em;
      transition: all 0.3s ease;
    }

    .view-toggle button.active {
      background: #6c63ff;
      border-color: #6c63ff;
    }

    .view-toggle button:hover {
      background: rgba(255, 255, 255, 0.1);
    }

    .view-toggle button.active:hover {
      background: #5750d4;
    }

    #canvas {
      flex: 1;
      background: #2a2a2a;
      border-radius: 10px;
      cursor: crosshair;
      display: none;
    }

    .ai-response {
      flex: 1;
      background: #2a2a2a;
      border-radius: 10px;
      padding: 20px;
      overflow-y: auto;
    }

    .ai-response::-webkit-scrollbar {
      width: 8px;
    }

    .ai-response::-webkit-scrollbar-track {
      background: #1a1a1a;
      border-radius: 4px;
    }

    .ai-response::-webkit-scrollbar-thumb {
      background: #3a3a3a;
      border-radius: 4px;
    }

    .ai-response::-webkit-scrollbar-thumb:hover {
      background: #4a4a4a;
    }

    .response-item {
      margin-bottom: 20px;
      padding: 15px;
      background: rgba(255, 255, 255, 0.03);
      border-radius: 10px;
      border: 1px solid rgba(255, 255, 255, 0.05);
    }

    .response-item:last-child {
      margin-bottom: 0;
    }

    .response-item h4 {
      margin-bottom: 10px;
      color: #6c63ff;
      font-size: 1.1em;
    }

    .response-item p {
      margin-bottom: 15px;
      line-height: 1.6;
      color: #e0e0e0;
    }

    .response-item .timestamp {
      font-size: 0.8em;
      color: #888;
      margin-top: 10px;
    }

    /* Chat history window */
    .chat-history {
      flex: 1;
      min-height: 0;
      display: flex;
      flex-direction: column;
    }

    .chat-history h3 {
      margin-bottom: 15px;
      color: #6c63ff;
    }

    .chat-history .history-list {
      flex: 1;
      overflow-y: auto;
      margin-bottom: 10px;
      padding: 5px;
    }

    .chat-history .history-list::-webkit-scrollbar {
      width: 8px;
    }

    .chat-history .history-list::-webkit-scrollbar-track {
      background: #1a1a1a;
      border-radius: 4px;
    }

    .chat-history .history-list::-webkit-scrollbar-thumb {
      background: #3a3a3a;
      border-radius: 4px;
    }

    .chat-history .history-list::-webkit-scrollbar-thumb:hover {
      background: #4a4a4a;
    }

    .history-item {
      padding: 12px;
      margin-bottom: 8px;
      background: rgba(255, 255, 255, 0.03);
      border-radius: 8px;
      font-size: 0.9em;
      cursor: pointer;
      transition: all 0.2s ease;
      border: 1px solid rgba(255, 255, 255, 0.05);
    }

    .history-item:hover {
      background: rgba(255, 255, 255, 0.05);
      transform: translateY(-1px);
    }

    /* Main message box */
    .message-box {
      grid-column: 2;
      grid-row: 1;
      height: 100%;
      display: flex;
      flex-direction: column;
    }

    .message-box .messages {
      flex: 1;
      overflow-y: auto;
      margin-bottom: 15px;
      padding: 10px;
    }

    .message-box .messages::-webkit-scrollbar {
      width: 8px;
    }

    .message-box .messages::-webkit-scrollbar-track {
      background: #1a1a1a;
      border-radius: 4px;
    }

    .message-box .messages::-webkit-scrollbar-thumb {
      background: #3a3a3a;
      border-radius: 4px;
    }

    .message-box .messages::-webkit-scrollbar-thumb:hover {
      background: #4a4a4a;
    }

    .message {
      margin-bottom: 15px;
      padding: 12px 15px;
      border-radius: 10px;
      max-width: 85%;
      position: relative;
    }

    .user-message {
      background: rgba(108, 99, 255, 0.1);
      margin-left: auto;
      border: 1px solid rgba(108, 99, 255, 0.2);
    }

    .message-box .input-area {
      display: flex;
      gap: 12px;
      align-items: flex-end;
      background: rgba(255, 255, 255, 0.03);
      padding: 15px;
      border-radius: 12px;
      border: 1px solid rgba(255, 255, 255, 0.05);
    }

    .message-box .input-container {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .message-box textarea {
      flex: 1;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 8px;
      padding: 12px;
      color: #fff;
      font-size: 1em;
      outline: none;
      resize: none;
      min-height: 60px;
      transition: all 0.3s ease;
    }

    .message-box textarea:focus {
      border-color: #6c63ff;
      background: rgba(255, 255, 255, 0.08);
    }

    .message-box .image-preview {
      max-width: 100px;
      max-height: 100px;
      border-radius: 8px;
      display: none;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .message-box .button-group {
      display: flex;
      gap: 8px;
    }

    .message-box button {
      background: #6c63ff;
      border: none;
      padding: 12px 20px;
      border-radius: 8px;
      color: #fff;
      font-size: 1em;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .message-box button:hover {
      background: #5750d4;
      transform: translateY(-1px);
    }

    .message-box .image-upload {
      background: rgba(255, 255, 255, 0.1);
      padding: 12px;
    }

    .message-box .image-upload:hover {
      background: rgba(255, 255, 255, 0.15);
    }

    .message-box .send-button {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .message-box .send-button::after {
      content: "â†’";
      font-size: 1.2em;
    }
  </style>
</head>
<body>
  <div class="top-left-container">
    <div class="window response-window">
      <div class="view-toggle">
        <button class="active" data-view="ai">AI Response</button>
        <button data-view="canvas">Canvas</button>
      </div>
      <div class="ai-response">
        <!-- Response items will be added here -->
      </div>
      <canvas id="canvas"></canvas>
    </div>

    <div class="window chat-history">
      <h3>Chat History</h3>
      <div class="history-list">
        <!-- History items will be added here -->
      </div>
    </div>
  </div>

  <div class="window message-box">
    <div class="messages">
      <div class="message user-message">
        Hi! How can you help me today?
      </div>
    </div>
    <div class="input-area">
      <div class="input-container">
        <textarea placeholder="Type your message..."></textarea>
        <img class="image-preview" id="imagePreview" alt="Image preview">
      </div>
      <div class="button-group">
        <input type="file" id="imageInput" accept="image/*" style="display: none">
        <button class="image-upload" onclick="document.getElementById('imageInput').click()">ðŸ“·</button>
        <button type="button" class="send-button">Send</button>
      </div>
    </div>
  </div>

  <script>
    // View toggle functionality
    const viewToggle = document.querySelector('.view-toggle');
    const aiResponse = document.querySelector('.ai-response');
    const canvas = document.getElementById('canvas');
    let currentView = 'ai';

    viewToggle.addEventListener('click', (e) => {
      if (e.target.tagName === 'BUTTON') {
        const view = e.target.dataset.view;
        if (view !== currentView) {
          viewToggle.querySelectorAll('button').forEach(btn => {
            btn.classList.toggle('active', btn.dataset.view === view);
          });

          if (view === 'canvas') {
            aiResponse.style.display = 'none';
            canvas.style.display = 'block';
            resizeCanvas();
          } else {
            canvas.style.display = 'none';
            aiResponse.style.display = 'block';
          }
          currentView = view;
        }
      }
    });

    // Canvas setup
    const ctx = canvas.getContext('2d');
    let isDrawing = false;
    let lastX = 0;
    let lastY = 0;

    // Chat functionality
    const messagesContainer = document.querySelector('.messages');
    const messageInput = document.querySelector('textarea');
    const sendButton = document.querySelector('.send-button');
    const historyList = document.querySelector('.history-list');
    
    // Store chat history and responses
    let chatHistory = JSON.parse(localStorage.getItem('chatHistory')) || [];
    let currentChatId = Date.now().toString();
    let responseHistory = [];

    // Add response to AI response view
    function addResponse(text) {
      const responseDiv = document.createElement('div');
      responseDiv.className = 'response-item';
      responseDiv.innerHTML = `
        <h4>AI Response</h4>
        <p>${text}</p>
        <div class="timestamp">${new Date().toLocaleTimeString()}</div>
      `;
      aiResponse.insertBefore(responseDiv, aiResponse.firstChild);
      responseHistory.unshift({
        text,
        timestamp: new Date()
      });
    }

    // Initialize chat history display
    function initializeChatHistory() {
      historyList.innerHTML = '';
      chatHistory.forEach(chat => {
        const historyItem = document.createElement('div');
        historyItem.className = 'history-item';
        historyItem.textContent = chat.title || 'Chat ' + new Date(chat.id).toLocaleString();
        historyItem.onclick = () => loadChat(chat.id);
        historyList.appendChild(historyItem);
      });
    }

    // Load a specific chat
    function loadChat(chatId) {
      currentChatId = chatId;
      const chat = chatHistory.find(c => c.id === chatId);
      if (chat) {
        messagesContainer.innerHTML = '';
        chat.messages.forEach(msg => {
          appendMessage(msg.text, msg.type, msg.image);
        });
      }
    }

    // Save current chat
    function saveChat() {
      const messages = Array.from(messagesContainer.children).map(msg => ({
        text: msg.textContent,
        type: msg.classList.contains('user-message') ? 'user' : 'llm',
        image: msg.querySelector('img')?.src
      }));

      const chatIndex = chatHistory.findIndex(c => c.id === currentChatId);
      const chatData = {
        id: currentChatId,
        title: messages[0]?.text?.substring(0, 30) + '...' || 'New Chat',
        messages: messages,
        timestamp: Date.now()
      };

      if (chatIndex === -1) {
        chatHistory.push(chatData);
      } else {
        chatHistory[chatIndex] = chatData;
      }

      localStorage.setItem('chatHistory', JSON.stringify(chatHistory));
      initializeChatHistory();
    }

    // Append a message to the chat
    function appendMessage(text, type, image = null) {
      const messageDiv = document.createElement('div');
      messageDiv.className = `message ${type}-message`;
      messageDiv.textContent = text;

      if (image) {
        const img = document.createElement('img');
        img.src = image;
        messageDiv.appendChild(img);
      }

      messagesContainer.appendChild(messageDiv);
      messagesContainer.scrollTop = messagesContainer.scrollHeight;
      saveChat();
    }

    // Handle sending messages
    async function sendMessage() {
      const text = messageInput.value.trim();
      const imagePreview = document.getElementById('imagePreview');
      const image = imagePreview.style.display !== 'none' ? imagePreview.src : null;

      if (text || image) {
        // Add user message
        appendMessage(text, 'user', image);

        // Clear input
        messageInput.value = '';
        imagePreview.style.display = 'none';
        imagePreview.src = '';

        // Simulate LLM response (replace this with actual LLM integration)
        setTimeout(() => {
          const response = "I understand your message. This is a simulated response. In a real implementation, this would be connected to an LLM API.";
          addResponse(response);
        }, 1000);
      }
    }

    // Event listeners for chat
    sendButton.addEventListener('click', sendMessage);
    messageInput.addEventListener('keypress', (e) => {
      if (e.key === 'Enter' && !e.shiftKey) {
        e.preventDefault();
        sendMessage();
      }
    });

    // Initialize chat history
    initializeChatHistory();

    // Canvas functionality
    function resizeCanvas() {
      const container = canvas.parentElement;
      canvas.width = container.clientWidth - 30;
      canvas.height = container.clientHeight - 60;
    }

    resizeCanvas();
    window.addEventListener('resize', resizeCanvas);

    canvas.addEventListener('mousedown', startDrawing);
    canvas.addEventListener('mousemove', draw);
    canvas.addEventListener('mouseup', stopDrawing);
    canvas.addEventListener('mouseout', stopDrawing);

    function startDrawing(e) {
      isDrawing = true;
      [lastX, lastY] = [e.offsetX, e.offsetY];
    }

    function draw(e) {
      if (!isDrawing) return;
      ctx.beginPath();
      ctx.moveTo(lastX, lastY);
      ctx.lineTo(e.offsetX, e.offsetY);
      ctx.strokeStyle = '#fff';
      ctx.lineWidth = 2;
      ctx.stroke();
      [lastX, lastY] = [e.offsetX, e.offsetY];
    }

    function stopDrawing() {
      isDrawing = false;
    }

    // Image upload preview
    const imageInput = document.getElementById('imageInput');
    const imagePreview = document.getElementById('imagePreview');

    imageInput.addEventListener('change', function(e) {
      const file = e.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
          imagePreview.src = e.target.result;
          imagePreview.style.display = 'block';
        }
        reader.readAsDataURL(file);
      }
    });
  </script>
</body>
</html>

